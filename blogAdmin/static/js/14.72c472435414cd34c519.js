webpackJsonp([14],{sge6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("qGD+"),r=a("W2KW"),i=a("4/BI"),n={data:function(){var e=this;return{sortObj:{sortBy:null,sortOrders:null},dialogBox:{boxShow:!1,isEdit:!1,detailItem:{}},pageObj:{pageSize:10,total:0,currentPage:1},tableData:{ref:"table",dataList:[],columns:[{prop:"name",sortable:"custom",label:"标签名称"},{prop:"description",label:"标签描述",showTooltip:!0},{prop:"bgColor",label:"标签背景色",render:function(e,t){return e("div",{style:{width:"120px",height:"20px",margin:"0 auto",background:t.row.bgColor}})}},{prop:"createUser",sortable:!0,label:"创建用户",render:function(e,t){return e("div",t.row.createUser?t.row.createUser.name:"--")}},{prop:"createTime",sortable:!0,label:"创建时间"},{prop:"operate",align:"center",label:"操作",render:function(t,a){return t("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},[t("el-button",{props:{type:"primary",size:"small"},style:{display:e.authList.includes("5e834f5afb69305aa091e828")?"block":"none"},on:{click:function(){e.dialogBox.detailItem=a.row,e.editData(a)}}},"编辑"),t("el-button",{props:{type:"danger",size:"small"},style:{display:e.authList.includes("5e834f61fb69305aa091e829")?"block":"none"},on:{click:function(){e.dataDel(a)}}},"删除")])}}]},searchForm:{labelWidth:"70px",ref:"searchRef",inline:!0,marginRight:"30px",formItemList:[{type:"text",prop:"name",width:"180px",label:"标签名称",placeholder:"请输入标签名称",blur:this.getDataList},{type:"date",dateType:"daterange",prop:"createTime",width:"300px",label:"创建时间",change:this.timeChange}],operate:[{name:"新增",hide:!1,handleClick:this.dataAdd}],formModel:{name:"",createTime:[]}},tagForm:{labelWidth:"100px",ref:"tagRef",labelPosition:"right",marginRight:"10px",formItemList:[{type:"text",prop:"name",width:"450px",label:"标签名称",placeholder:"请输入标签名称"},{type:"text",prop:"description",width:"450px",label:"标签描述",placeholder:"请输入标签描述"},{slot:"color",prop:"bgColor",width:"450px",label:"标签背景色"}],formModel:{name:"",description:"",bgColor:"#409EFF"},rules:{name:[{required:!0,validator:i.a.FormValidate.Form("标签名称").NoEmpty,trigger:"blur"}],bgColor:[{required:!0,validator:i.a.FormValidate.Form("标签背景色").TypeSelect,trigger:"change"}]}}}},created:function(){this.searchForm.operate[0].hide=!this.authList.includes("5e834f51fb69305aa091e827")},mounted:function(){this.getDataList()},methods:{getDataList:function(e){var t=this;this.pageObj.currentPage=!0===e?this.pageObj.currentPage:1;var a=this.searchForm.formModel,o=this.sortObj,r=o.sortBy,i=o.sortOrders;this.$api.article.tagList({currentPage:this.pageObj.currentPage,pageSize:this.pageObj.pageSize,name:a.name,createTime:a.createTime?a.createTime.join(","):null,sortBy:r,sortOrders:i}).then(function(e){e.code===t.$constant.reqSuccess?(t.pageObj.total=e.data.count,t.tableData.dataList=e.data.data):t.$message.warning("获取标签列表失败")})},sortChange:function(e){e.order?this.sortObj={sortBy:e.prop,sortOrders:e.order}:this.sortObj={sortBy:null,sortOrders:null},this.getDataList()},timeChange:function(e){this.searchForm.formModel.createTime=e||null,this.getDataList()},dataAdd:function(){this.$refs.tagRef&&this.$refs.tagRef.$refs.tagRef.resetFields(),this.dialogBox.isEdit=!1,this.dialogBox.boxShow=!0},editData:function(e){var t=this;this.dialogBox.isEdit=!0,this.dialogBox.boxShow=!0,this.$nextTick(function(){t.$refs.tagRef&&t.$refs.tagRef.$refs.tagRef.resetFields(),t.tagForm.formModel={name:e.row.name,description:e.row.description,bgColor:e.row.bgColor}})},confirSubmit:function(){var e=this;this.$refs.tagRef.$refs.tagRef.validate(function(t){var a=e.dialogBox,o=e.tagForm.formModel;t?a.isEdit?e.$api.article.tagUpdate({id:a.detailItem._id,name:o.name,description:o.description,bgColor:o.bgColor}).then(function(t){var a=t.code;a===e.$constant.reqSuccess?(e.dialogBox.boxShow=!1,e.getDataList(),e.$message.success("标签信息更新成功")):a===e.$constant.dataAlready?(e.$message.warning("标签名称已存在"),o.name=""):e.$message.warning("标签信息更新失败")}):e.$api.article.tagAdd({name:o.name,description:o.description,bgColor:o.bgColor}).then(function(t){var a=t.code;a===e.$constant.reqSuccess?(e.dialogBox.boxShow=!1,e.getDataList(),e.$message.success("标签信息添加成功")):a===e.$constant.dataAlready?(e.$message.warning("标签名称已存在"),o.name=""):e.$message.warning("标签信息添加失败")}):e.$message.warning("信息校验失败")})},dataDel:function(e){var t=this;this.$confirm("此操作将删除该标签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$api.article.tagDel(e.row._id).then(function(e){e.code===t.$constant.reqSuccess?(t.getDataList(),t.$message.success("标签删除成功")):t.$message.warning("标签删除失败")})}).catch(function(){})},pageChange:function(e){this.pageObj.currentPage=e,this.getDataList(!0)}},components:{MyTable:o.a,MyForm:r.a},computed:{authList:function(){return this.$store.getters.getAuthList}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper"},[a("h2",{staticClass:"content-title"},[e._v("文章标签")]),e._v(" "),a("div",{staticClass:"box-table"},[a("my-form",{ref:e.searchForm.ref,attrs:{formConfig:e.searchForm}}),e._v(" "),a("my-table",{attrs:{tableData:e.tableData,pageObj:e.pageObj},on:{sortChange:e.sortChange,pageChange:e.pageChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogBox.isEdit?"编辑标签":"新增标签",visible:e.dialogBox.boxShow,width:"640px"},on:{"update:visible":function(t){return e.$set(e.dialogBox,"boxShow",t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.confirSubmit(t)}}},[a("my-form",{ref:e.tagForm.ref,attrs:{formConfig:e.tagForm}},[a("el-color-picker",{attrs:{slot:"color"},slot:"color",model:{value:e.tagForm.formModel.bgColor,callback:function(t){e.$set(e.tagForm.formModel,"bgColor",t)},expression:"tagForm.formModel.bgColor"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogBox.boxShow=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(n,s,!1,function(e){a("vbyL")},"data-v-039561e5",null);t.default=l.exports},vbyL:function(e,t){}});